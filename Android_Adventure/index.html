<!DOCTYPE html>
<html>
<head>
    <title>Android Adventure</title>
    <script id="cboxscript" type="text/x-javascript">
        var cboxgame = {
            fireEvent : function(data){
                if( data.btnX == 1 ){
                    testCall();
                }
            }
        };
        var testCall = function(){

        };
        collie.ImageManager.addImages({
            "bird_walk" : "./img/bird_walk.png",
            "bird_jump" : "./img/bird_jump.png",
            "ground" : "./img/ground.png"
        }, function () {
            var layer = new collie.Layer({
                width : 300,
                height : 300
            }).attach({
                        click : function () {
                            if (oTimerJump === null) {
                                oTimer.stop();
                                oAvatarWalk.set("visible", false);
                                oAvatarJump.set("visible", true);
                                oTimerJump = collie.Timer.cycle(oAvatarJump, "17fps", {
                                    from : 0,
                                    to : 16,
                                    loop : 1,
                                    onComplete : function () {
                                        oTimer = collie.Timer.cycle(oAvatarWalk, "20fps", {
                                            from : 0,
                                            to : 9,
                                            loop : 0
                                        });
                                        oTimerJump = null;
                                        oAvatarWalk.set("visible", true);
                                        oAvatarJump.set("visible", false);
                                    }
                                });
                            }
                        }
                    });

            var oTimerJump = null;

            testCall = function(){
                if (oTimerJump === null) {
                    oTimer.stop();
                    oAvatarWalk.set("visible", false);
                    oAvatarJump.set("visible", true);
                    oTimerJump = collie.Timer.cycle(oAvatarJump, "17fps", {
                        from : 0,
                        to : 16,
                        loop : 1,
                        onComplete : function () {
                            oTimer = collie.Timer.cycle(oAvatarWalk, "20fps", {
                                from : 0,
                                to : 9,
                                loop : 0
                            });
                            oTimerJump = null;
                            oAvatarWalk.set("visible", true);
                            oAvatarJump.set("visible", false);
                        }
                    });
                }
            }

            var oGround = new collie.MovableObject({
                x : 0,
                y : 300 - 88,
                width : 320 * 2, // 연속적으로 이어질 수 있도록 화면 밖으로 벗어나도록 그림
                height : 88,
                velocityX : -80, // 속도
                backgroundRepeat : "repeat-x", // 배경을 반복해서 그림
                rangeX : [-320, 0], // x좌표의 범위를 지정
                positionRepeat : true, // 범위를 벗어나면 다시 반대쪽으로 돌아오도록 설정
                backgroundImage : "ground"
            }).addTo(layer);

            var oAvatarContainer = new collie.DisplayObject({
                x : 50,
                y : 80,
                width : 70,
                height : 150
            }).addTo(layer);

            var oAvatarWalk = new collie.DisplayObject({
                x : 0,
                y : 0,
                width : 70,
                height : 150,
                backgroundImage : "bird_walk"
            }).addTo(oAvatarContainer);

            var oAvatarJump = new collie.DisplayObject({
                width : 70,
                height : 150,
                spriteLength : 17,
                backgroundImage : "bird_jump",
                visible : false
            }).addTo(oAvatarContainer);

            var oTimer = collie.Timer.cycle(oAvatarWalk, "20fps", {
                from : 0,
                to : 9,
                loop : 0
            });

            collie.Renderer.addLayer(layer);
            collie.Renderer.load(document.getElementById("container"));
            collie.Renderer.start(1000 / 30);
        });


    </script>
</head>
<body style="width:100%;height:100%;background-color:black">
<div id="container" class="container"></div>
</body>
</html>